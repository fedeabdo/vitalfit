<!DOCTYPE html>
<html>

<head>
	<title>Vitalfit</title>
	<meta name="viewport" content="minimal-ui, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
	<meta name="msapplication-tap-highlight" content="no" />
	<meta name="format-detection" content="telephone=no" />

	<link rel="stylesheet" href="mobileui/mui.min.css" type="text/css">
	<link rel="stylesheet" href="custom/custom.css" type="text/css">
	<link rel="stylesheet" href="node_modules/keen-ui/dist/keen-ui.min.css">

	<script src="phonegap.js"></script>
	<script src="vendors/fastclick.min.js" type="text/javascript"></script>

	<script src="vendors/jquery.min.js" type="text/javascript"></script>
	<script src="vendors/jquery.animate-enhanced.js" type="text/javascript"></script>
	<script src="vendors/jqwait/jquery.wait.min.js" type="text/javascript"></script>
	<script src="vendors/iscroll-min.js" type="text/javascript"></script>

	<script src="mobileui/mui.min.js" type="text/javascript"></script>
	<script src="custom/custom.js" type="text/javascript"></script>

	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<script src="node_modules/keen-ui/dist/keen-ui.min.js"></script>

    
	<script>
		$(document).ready(() => {

            $.ajax({
				type: 'GET',
				url: 'https://app-personal-trainer.herokuapp.com/myinfo',
				xhrFields: { withCredentials: true },
				crossDomain: true,
				success: function(data){
					homePage.alumno = data
				}
			})
			
			
            const homePage = new Vue({
				el: "#home-page",
				data: {
					alumno: {
                        username: String,
                        nombre: String,
                        nacimiento: Date,
                        nro_contacto: Number,
                        mail: String,
                        planes: Array
                    },
					
				},
				methods: {
					verPlanes: function(){
						$.ajax({
							type: 'GET',
							url: 'https://app-personal-trainer.herokuapp.com/myinfo/planes',
							xhrFields: { withCredentials: true },
							crossDomain: true,
							success: function(data){
								planesPage.planes = data
							}
						})
						mui.viewport.showPage("planes-page", 'DEF')
					},
					verPlanActual: function(){
						$.ajax({
							type: 'GET',
							url: 'https://app-personal-trainer.herokuapp.com/myinfo/plan_asignado',
							xhrFields: { withCredentials: true },
							crossDomain: true,
							success: function(data){
								planPage.plan = data
							}
						})
						mui.viewport.showPage("plan-page", 'DEF')
					}
					
				}
			})
            
            const planesPage = new Vue({
				el:"#planes-page",
				data: {
					planes: []
				},
                methods: {
					showPagePlan: function () {
						mui.viewport.showPage("plan-page", "DEF");
                    },
                    handleSelectPlan: function(plan){
						planPage.plan = plan;
						mui.viewport.showPage("plan-page", "DEF");
                    }
				}
			})

			const menuPanel = new Vue({
				el: "#menu-panel",
				methods:{
					logout: function(){
						$.ajax({
							type: 'GET',
							url: 'https://app-personal-trainer.herokuapp.com/logout',
							xhrFields: { withCredentials: true },
							crossDomain: true,
							success: function(data){
								document.location.href = "index.html"
							}
						})
					}
				}
			})

			const planPage = new Vue({
				el:"#plan-page",
				data: {
					plan: Object
				},
                methods: {
					handleSelectDia: function(dia){
						diaPage.dia = dia;
						mui.viewport.showPage("dia-page", "DEF");
					}
				}
				
			})

			const diaPage = new Vue({
				el:"#dia-page",
				data: {
					dia: Object
				},
                methods: {
					handleSelectEjercicio: function(ejercicio){
						ejercicioPage.ejercicio = ejercicio;
						mui.viewport.showPage("ejercicio-page", "DEF");
					}
				}
				
			})

			const ejercicioPage = new Vue({
				el:"#ejercicio-page",
				data: {
					ejercicio: Object
				},
                methods: {
					confirmarSesionEjercicios: function(){
						$.ajax({
							type: 'PUT',
							url: 'https://app-personal-trainer.herokuapp.com/myinfo/plan_asignado',
							xhrFields: { withCredentials: true },
							crossDomain: true,
							success: function(data){
								planPage.plan = data
							}
						})
					}
				}
				
			})
		})
	</script>


</head>

<body>
	<!-- Main wrapper. Importantly, think carefully before you change it or remove it. Do not recommend it. -->
	<!-- Main wrapper. Importante, Piénselo bien antes de cambiarlo o quitarlo. No se lo recomiendo. -->
	<div id="mui-screen" class="mui-viewport">
		<div id="mui-screen-page" class="mui-page">
			<!-- Ddefault viewport. Do not remove. It will make your life simpler and happy. -->
			<!-- ViewPort por defecto. No lo elimines. Hará tu vida más simple y feliz. -->
			<div id="mui-viewport" class="mui-viewport">
				<div id="home-page" class="mui-page">
					<div class="mui-page-header">
						<div class="mui-page-logo"></div>
						<a class="mui-headmenu" href="#"></a>
					</div>
					<div class="mui-page-body" id="home-body">
						<div>
							<div class="col-80">
                                <p> Bienvenido {{alumno.nombre}} </p>
                                <span>
									<button class="col-80" @click="verPlanes"> Mostrar todos los planes </button>
								</span>
								<span>
									<button class="col-80" @click="verPlanActual"> Mostrar plan actual </button>
								</span>
							</div>
						</div>
					</div>
				</div>

				<!-- CARGA DE DATOS PLAN ANTERIOR -->
				<div id='planes-page' class="mui-page">
                    <div class="mui-page-header">
                        <a class="mui-backarrow" href="#"></a>
                        <div class='mui-page-title'> Planes </div>
						<div class="mui-page-logo"></div>
						<a class="mui-headmenu" href="#"></a>
					</div>
					<div class="mui-page-body" id="home-body" style="overflow:scroll">
						<div>
							<div class="col-80">
                                <p> Lista de planes</p>
                                <span>
									<button class="col-80" v-for="plan in planes" @click="handleSelectPlan(plan)">{{plan.nombre}}</button>
								</span>
							</div>
						</div>
					</div>
                </div>

                <div id='plan-page' class="mui-page">
					<div class="mui-page-header">
						<a class="mui-backarrow" href="#"></a>
						<div class='mui-page-title'>{{plan.nombre}}</div>
						<a class="mui-headmenu" href="#"></a>
					</div>
					<div class="mui-page-body mui-scrollable" id="second-body">
						<div id="plan-inside">
							<button class="col-80" v-for="dia in plan.dias" @click="handleSelectDia(dia)">{{dia.nombre}}</button>
						</div>
					</div>
				</div>
				
				<div id='dia-page' class="mui-page">
					<div class="mui-page-header">
						<a class="mui-backarrow" href="#"></a>
						<div class='mui-page-title'>{{dia.nombre}}</div>
						<a class="mui-headmenu" href="#"></a>
					</div>
					<div class="mui-page-body mui-scrollable" id="second-body">
						<div class="col-80">
							<div class="iniciar-sesion-ventana" v-for="ejercicio in dia.ejercicios" @click="handleSelectEjercicio(ejercicio)">
								<!-- <img src="img1.jpg" style="width:100%"> -->
								<button class="col-80">{{ejercicio.nombre}}</button>
								<div v-for="sesion in ejercicio.sesiones"> {{sesion.nombre}} </div>
							</div>
						</div>
						<!-- Next and previous buttons -->
					</div>
					<br>
				</div>
				<div id='ejercicio-page' class="mui-page">
					<div class="mui-page-header">
						<a class="mui-backarrow" href="#"></a>
						<div class='mui-page-title'> Agregar sesion a {{ejercicio.nombre}}</div>
						<a class="mui-headmenu" href="#"></a>
					</div>
					<div class="mui-page-body mui-scrollable" id="second-body">
						<div class= "col-80">

							<p>Nombre:</p><input type="String" placeholder="" v-model="sesios.series">
							<br>
							<p>Series:</p><input type="Number" placeholder="Series realizadas" v-model="sesion.series">
							<br>
							<p>Intensidad:</p><input type="Number" placeholder="Intensidad Alcanzada" v-model="sesion.intensidad">
							<br>
							<p>Tiempo:</p><input type="Number" placeholder="Tiempo de Ejecución" v-model="sesion.tiempo">
							<br>
						</div>
						<hr style="width:95%; height:3px; border-width:0; color:gray; background-color:gray">
							<br>
							<button class="confirmar_boton" @click="confirmarSesionEjercicios">Confirmar</button>
					</div>
				</div>
                
				<!-- Optional.Toolbar out of mui-viewport to be omnipresent. Remove if not needed. -->
				<!-- Opcional. Barra de herramientas fuera de mui-viewport para ser omnipresente. Elimínalo si no lo necesitas. -->
				<div class="mui-tabbar" id="footer">
					<ul class="mui-tabbar-list">
						<li class="mui-tabbar-button"><a href="#" id="tabbar-button1"></a></li>
						<li class="mui-tabbar-button"><a href="#" id="tabbar-button2"></a></li>
						<li class="mui-tabbar-button"><a href='#' id="tabbar-button3"></a></li>
					</ul>
				</div>
			</div>

			<!-- mui-screen level panel -->
			<!-- Panel a nivel de mui-screen -->
		</div>
		<div id="menu-panel" class="mui-panel">
			<div class="mui-panel-header">
				<div class='mui-panel-title'>Menu</div>
			</div>
			<div class="mui-panel-body">
				<div>
					<ul id='menuoptions' class='mui-list'>
						<li><a @click="logout">Cerrar sesión</li></a>
						<li><a id='option1' href="#">Go Home Page</a></li>
						<li><a id='option2' href="#">Go Page 2</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>


</body>

</html>